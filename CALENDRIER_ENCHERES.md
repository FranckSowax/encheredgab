# ğŸ“… Calendrier Hebdomadaire des EnchÃ¨res

## ğŸ¯ Cycle de Vente Hebdomadaire

### Vue d'Ensemble

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SEMAINE TYPE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  Lundi - Mercredi  â”‚  PRÃ‰VISUALISATION                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                  â”‚
â”‚  ğŸ“± Mode Vitrine   â”‚  â€¢ Lots visibles                   â”‚
â”‚                    â”‚  â€¢ Prix de dÃ©part affichÃ©s          â”‚
â”‚                    â”‚  â€¢ Pas d'enchÃ¨res possibles         â”‚
â”‚                    â”‚  â€¢ CTA: "EnchÃ¨res jeudi 00h00"      â”‚
â”‚                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  Jeudi 00h00       â”‚  OUVERTURE DES ENCHÃˆRES            â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                  â”‚
â”‚  ğŸ”¥ Mode Actif     â”‚  â€¢ EnchÃ¨res activÃ©es               â”‚
â”‚                    â”‚  â€¢ Bouton "Faire une offre" actif   â”‚
â”‚                    â”‚  â€¢ Temps restant affichÃ©            â”‚
â”‚                    â”‚  â€¢ Notifications activÃ©es           â”‚
â”‚                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  Vendredi 12h00    â”‚  CLÃ”TURE                           â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                  â”‚
â”‚  âœ… TerminÃ©        â”‚  â€¢ EnchÃ¨res fermÃ©es                â”‚
â”‚                    â”‚  â€¢ Gagnants notifiÃ©s                â”‚
â”‚                    â”‚  â€¢ Process de paiement              â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Planning DÃ©taillÃ©

### Lundi Ã  Mercredi (Mode PrÃ©visualisation)

**DurÃ©e** : 72 heures  
**Status** : `preview` ou `scheduled`

#### FonctionnalitÃ©s Actives
- âœ… Affichage des lots
- âœ… Description complÃ¨te
- âœ… Prix de dÃ©part visible
- âœ… Images et dÃ©tails
- âœ… Favoris possibles
- âœ… Partage social
- âœ… Questions/RÃ©ponses

#### FonctionnalitÃ©s DÃ©sactivÃ©es
- âŒ Bouton "Faire une offre" (grisÃ©)
- âŒ EnchÃ¨res
- âŒ Auto-bid
- âŒ Notifications enchÃ¨res

#### Interface Utilisateur

**Badge sur les cartes** :
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ• EnchÃ¨res dÃ¨s    â”‚
â”‚    Jeudi 00h00     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Message CTA** :
```
Les enchÃ¨res dÃ©buteront jeudi Ã  minuit
ğŸ“Œ Ajoutez ce lot Ã  vos favoris pour Ãªtre notifiÃ©
```

---

### Jeudi 00h00 (Ouverture)

**DÃ©clencheur** : Automatique Ã  minuit  
**Status** : `active`

#### Actions Automatiques
1. ğŸ”„ Changement status : `scheduled` â†’ `active`
2. ğŸ“§ Envoi notifications push
3. ğŸ“± SMS aux utilisateurs avec favoris
4. ğŸ”” WhatsApp aux enchÃ©risseurs inscrits
5. ğŸ“Š Analytics : dÃ©but tracking

#### Notifications EnvoyÃ©es

**WhatsApp** :
```
ğŸ”” Douane EnchÃ¨res - Ouverture !

Les enchÃ¨res sont maintenant OUVERTES ! ğŸ‰

Vos lots favoris :
â€¢ Mercedes GLE 2023 - DÃ©part: 15M FCFA
â€¢ iPhone 14 Pro - DÃ©part: 450K FCFA

â° Fin des enchÃ¨res : Vendredi 12h00

ğŸ‘‰ Faire une offre : [lien]
```

**Email** :
```
Subject: ğŸ”¥ Les enchÃ¨res sont ouvertes !

Bonjour [Nom],

Les lots que vous suivez sont maintenant disponibles 
aux enchÃ¨res jusqu'Ã  vendredi midi.

[Liste des lots favoris avec boutons CTA]
```

---

### Jeudi 00h00 - Vendredi 12h00 (PÃ©riode Active)

**DurÃ©e** : 36 heures  
**Status** : `active`

#### FonctionnalitÃ©s Actives
- âœ… EnchÃ¨res en temps rÃ©el
- âœ… Auto-bid
- âœ… Snipe protection
- âœ… Notifications outbid
- âœ… Extension anti-snipe
- âœ… Tableau des enchÃ¨res

#### SystÃ¨me de Notifications

**Instant** (temps rÃ©el) :
- ğŸ”” EnchÃ¨re dÃ©passÃ©e
- ğŸ† Nouveau leader
- âš¡ Extension time

**ProgrammÃ©es** :
- â° 6h avant fin : "DerniÃ¨res heures"
- â° 1h avant fin : "DerniÃ¨re heure !"
- â° 15min avant fin : "Derniers instants !"

---

### Vendredi 12h00 (ClÃ´ture)

**DÃ©clencheur** : Automatique Ã  midi  
**Status** : `completed`

#### Actions Automatiques

1. **Fermeture des enchÃ¨res**
   ```sql
   UPDATE auctions 
   SET status = 'completed', 
       winner_id = (SELECT user_id FROM bids 
                    WHERE auction_id = auctions.id 
                    ORDER BY amount DESC LIMIT 1)
   WHERE end_date <= NOW()
   ```

2. **Notification gagnants**
   - WhatsApp
   - Email
   - SMS
   - Push notification

3. **Notification perdants**
   - Email de remerciement
   - Suggestion lots similaires

4. **Process paiement**
   - GÃ©nÃ©ration facture
   - Instructions paiement
   - QR Code livraison

---

## ğŸ”§ ImplÃ©mentation Technique

### 1. Migration Base de DonnÃ©es

```sql
-- Ajouter champs planning
ALTER TABLE auctions ADD COLUMN preview_start TIMESTAMPTZ;
ALTER TABLE auctions ADD COLUMN bidding_start TIMESTAMPTZ;
ALTER TABLE auctions ADD COLUMN bidding_end TIMESTAMPTZ;

-- Fonction pour calculer les dates
CREATE OR REPLACE FUNCTION schedule_weekly_auction(
  p_preview_start TIMESTAMPTZ
)
RETURNS TABLE (
  preview_start TIMESTAMPTZ,
  bidding_start TIMESTAMPTZ,
  bidding_end TIMESTAMPTZ
) AS $$
BEGIN
  -- Preview : Lundi 00h00
  preview_start := date_trunc('week', p_preview_start) + INTERVAL '0 days';
  
  -- Bidding start : Jeudi 00h00
  bidding_start := date_trunc('week', p_preview_start) + INTERVAL '3 days';
  
  -- Bidding end : Vendredi 12h00
  bidding_end := date_trunc('week', p_preview_start) + INTERVAL '4 days 12 hours';
  
  RETURN QUERY SELECT preview_start, bidding_start, bidding_end;
END;
$$ LANGUAGE plpgsql;
```

### 2. Scheduler (Cron Job)

**Ouverture EnchÃ¨res** - Jeudi 00h00 :
```typescript
// app/api/cron/open-weekly-auctions/route.ts
export async function GET() {
  const now = new Date()
  const isThursdayMidnight = now.getDay() === 4 && now.getHours() === 0
  
  if (!isThursdayMidnight) {
    return NextResponse.json({ skipped: true })
  }

  // Activer les enchÃ¨res scheduled
  const { data, error } = await supabase
    .from('auctions')
    .update({ status: 'active' })
    .eq('status', 'scheduled')
    .lte('start_date', now.toISOString())
  
  // Envoyer notifications
  await notifyAuctionOpening()
  
  return NextResponse.json({ activated: data?.length || 0 })
}
```

**ClÃ´ture EnchÃ¨res** - Vendredi 12h00 :
```typescript
// app/api/cron/close-weekly-auctions/route.ts
export async function GET() {
  const now = new Date()
  const isFridayNoon = now.getDay() === 5 && now.getHours() === 12
  
  if (!isFridayNoon) {
    return NextResponse.json({ skipped: true })
  }

  // Fermer les enchÃ¨res actives
  const { data: closedAuctions } = await supabase
    .from('auctions')
    .update({ status: 'completed' })
    .eq('status', 'active')
    .lte('end_date', now.toISOString())
    .select('*, bids(*)')
  
  // DÃ©terminer les gagnants
  for (const auction of closedAuctions) {
    await determineWinner(auction)
  }
  
  return NextResponse.json({ closed: closedAuctions.length })
}
```

### 3. Composant UI

```tsx
// components/ui/WeeklyScheduleBanner.tsx
export function WeeklyScheduleBanner() {
  const now = new Date()
  const dayOfWeek = now.getDay() // 0=Dimanche, 1=Lundi, ..., 5=Vendredi
  const hour = now.getHours()
  
  // Lundi-Mercredi (jours 1-3)
  if (dayOfWeek >= 1 && dayOfWeek <= 3) {
    return (
      <div className="bg-blue-50 border-2 border-blue-200 rounded-xl p-4">
        <h3 className="font-bold text-blue-800">
          ğŸ“± Mode PrÃ©visualisation
        </h3>
        <p className="text-blue-700">
          Les enchÃ¨res dÃ©buteront <strong>jeudi Ã  minuit</strong>
        </p>
        <Countdown target="jeudi 00:00" />
      </div>
    )
  }
  
  // Jeudi-Vendredi midi (enchÃ¨res actives)
  if (dayOfWeek === 4 || (dayOfWeek === 5 && hour < 12)) {
    return (
      <div className="bg-green-50 border-2 border-green-200 rounded-xl p-4">
        <h3 className="font-bold text-green-800">
          ğŸ”¥ EnchÃ¨res en cours !
        </h3>
        <p className="text-green-700">
          ClÃ´ture <strong>vendredi Ã  12h00</strong>
        </p>
        <Countdown target="vendredi 12:00" />
      </div>
    )
  }
  
  // Vendredi aprÃ¨s-midi - Dimanche
  return (
    <div className="bg-gray-50 border-2 border-gray-200 rounded-xl p-4">
      <h3 className="font-bold text-gray-800">
        âœ… EnchÃ¨res terminÃ©es
      </h3>
      <p className="text-gray-700">
        Prochaines enchÃ¨res : <strong>lundi prochain</strong>
      </p>
    </div>
  )
}
```

---

## ğŸ“± ExpÃ©rience Utilisateur

### Mode PrÃ©visualisation (Lundi-Mercredi)

**Page d'accueil** :
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—“ï¸ Prochaines EnchÃ¨res                 â”‚
â”‚  Jeudi 00h00 - Vendredi 12h00          â”‚
â”‚                                         â”‚
â”‚  â° Ouverture dans: 2j 14h 30min       â”‚
â”‚                                         â”‚
â”‚  [Voir les lots] [Activer alertes]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Carte produit** :
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Image]              â”‚
â”‚ ğŸ• EnchÃ¨res dÃ¨s     â”‚
â”‚    Jeudi 00h00      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Mercedes GLE 2023    â”‚
â”‚ Prix dÃ©part:         â”‚
â”‚ 15 000 000 FCFA     â”‚
â”‚                      â”‚
â”‚ [â¤ï¸ Suivre]         â”‚
â”‚ [DÃ©tails]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Mode Actif (Jeudi-Vendredi)

**Carte produit** :
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Image]              â”‚
â”‚ â° Fin dans:        â”‚
â”‚    12h 30min        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Mercedes GLE 2023    â”‚
â”‚ EnchÃ¨re actuelle:    â”‚
â”‚ 16 500 000 FCFA     â”‚
â”‚ ğŸ”¥ 23 enchÃ¨res      â”‚
â”‚                      â”‚
â”‚ [Faire une offre]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Configuration Admin

### Interface de Planification

```tsx
// app/(dashboard)/admin/weekly-schedule/page.tsx
export default function WeeklySchedulePage() {
  return (
    <div>
      <h1>Planification Hebdomadaire</h1>
      
      {/* Semaine en cours */}
      <WeekTimeline currentWeek={currentWeek} />
      
      {/* Lots Ã  planifier */}
      <LotScheduler 
        onSchedule={(lotId, week) => {
          // Assigner lot Ã  une semaine
        }}
      />
      
      {/* Calendrier des prochaines semaines */}
      <UpcomingWeeks weeks={nextWeeks} />
    </div>
  )
}
```

---

## ğŸ“Š MÃ©triques & Analytics

### KPIs Ã  Suivre

- ğŸ“ˆ **Taux de conversion Preview â†’ Bid**
- â° **Heure pic des enchÃ¨res**
- ğŸ’° **Augmentation moyenne du prix**
- ğŸ‘¥ **Participants par semaine**
- ğŸ”” **Taux d'ouverture notifications**

---

## âœ… Checklist d'ImplÃ©mentation

- [ ] Migration DB (dates planning)
- [ ] Fonction calcul dates hebdo
- [ ] Cron job ouverture (jeudi 00h)
- [ ] Cron job clÃ´ture (vendredi 12h)
- [ ] Composant WeeklyScheduleBanner
- [ ] Mode preview sur cartes
- [ ] Notifications ouverture
- [ ] Notifications clÃ´ture
- [ ] Interface admin planning
- [ ] Tests cycle complet

---

**Ce systÃ¨me garantit un cycle rÃ©gulier et prÃ©visible pour maximiser l'engagement ! ğŸš€**
